webpackJsonp([1],{"+tBu":function(t,e,n){"use strict";var o=n("/oeL"),r=n("Z04r");n.d(e,"a",function(){return c});var s=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=this&&this.__param||function(t,e){return function(n,o){e(n,o,t)}},c=function(){function t(t,e){this.dialogRef=t,this.data=e,this.onLogin=new o.EventEmitter}return t.prototype.login=function(){console.log("Logging in...");var t={email:this.email,password:this.password};this.onLogin.emit(t),this.data.consumer.login(t)},t}();s([n.i(o.Output)(),i("design:type",Object)],c.prototype,"onLogin",void 0),s([n.i(o.Input)(),i("design:type",Object)],c.prototype,"errorMsg",void 0),c=s([n.i(o.Component)({selector:"login-component",template:n("8Vg4"),styles:[n("dCN4")]}),a(1,n.i(o.Inject)(r.b)),i("design:paramtypes",["function"==typeof(p=void 0!==r.c&&r.c)&&p||Object,Object])],c);var p},0:function(t,e,n){t.exports=n("cDNt")},"0+Pn":function(t,e,n){"use strict";var o=n("/oeL"),r=n("bKpL"),s=(n.n(r),n("8k1a")),i=n("B2Lq"),a=n("xrDH");n.n(a);n.d(e,"a",function(){return d});var c=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(){}return t.prototype.isAdmin=function(){return this.roles&&1==this.roles.admin},t.prototype.isUpdater=function(){return this.roles&&1==this.roles.updater},t.prototype.isFsgOverseer=function(){return this.roles&&1==this.roles.fsgoverseer},t.prototype.isPublisher=function(){return this.roles&&1==this.roles.publisher},Object.defineProperty(t.prototype,"hasUserInfo",{get:function(){return this.roles&&this.userInfoObj},enumerable:!0,configurable:!0}),t}(),d=function(){function t(t,e){this.af=t,this.db=e,this.roleList=["admin","updater","fsgoverseer","publisher"],this.onCurrentUserInfo=new o.EventEmitter}return t.prototype.getUser=function(){return this.af.auth.currentUser},t.prototype.getUserObs=function(){return this.af.authState},t.prototype.isLoggedIn=function(){return null!=this.getUser()},t.prototype.onAuthChange=function(t){this.af.auth.onAuthStateChanged(t)},t.prototype.login=function(t,e){return this.af.auth.signInWithEmailAndPassword(t,e)},t.prototype.logout=function(){return this.af.auth.signOut()},t.prototype.getUserRole=function(t){return this.db.object("/roles/"+t.userObj.uid).flatMap(function(e){return t.roles=e,r.Observable.of(t)})},t.prototype.getUserInfo=function(t){return this.db.object("/users/"+t.userObj.uid).flatMap(function(e){return t.userInfoObj=e,r.Observable.of(t)})},t.prototype.getAllUserInfo=function(){var t=this;this.currentUser=new u,this.currentUser.userObj=this.getUser(),this.getUserRole(this.currentUser).flatMap(function(e){return t.getUserInfo(t.currentUser)}).subscribe(function(e){console.log("Emitting..."),console.log(t.currentUser),t.onCurrentUserInfo.emit(t.currentUser)})},t.prototype.getAllUsersList=function(){var t=this;return this.usersList?r.Observable.of(this.usersList):this.db.list("/users/list").flatMap(function(e){return t.usersList?t.usersList.length=0:t.usersList=[],r.Observable.from(e)}).flatMap(function(e){return t.db.object("/users/"+e.$value).flatMap(function(e){return a.remove(t.usersList,function(t){return t.$key==e.$key}),t.usersList.push(e),r.Observable.of(e)})}).debounceTime(300).flatMap(function(e){return r.Observable.of(t.usersList)})},t}();c([n.i(o.Output)(),p("design:type",Object)],d.prototype,"onCurrentUserInfo",void 0),d=c([n.i(o.Injectable)(),p("design:paramtypes",["function"==typeof(l=void 0!==s.a&&s.a)&&l||Object,"function"==typeof(h=void 0!==i.a&&i.a)&&h||Object])],d);var l,h},"0o1w":function(t,e,n){"use strict";var o=n("/oeL"),r=n("GsmQ"),s=n("Z04r"),i=n("HGbW"),a=n("0+Pn"),c=n("xrDH");n.n(c);n.d(e,"a",function(){return l});var p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},d=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(t){function e(e,n,o){var r=t.call(this)||this;return r.mapService=o,r.loaded=!1,r.dialog=e,r.fireAuth=n,r}return p(e,t),e.prototype.load=function(){this.showLoadingDialog(),this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater()?(console.log("Loading current maps..."),this.getAllMapsList()):this.getAllUserMaps(),this.subs.push(this.fireAuth.getAllUsersList().subscribe(function(t){console.log("User list pre-loaded..")}))},e.prototype.getAllUserMaps=function(){var t=this;console.log("Getting all user maps..."),this.subs.push(this.mapService.getUserMaps(this.fireAuth.currentUser).subscribe(function(e){console.log("Got all user maps..."),t.loaded||(c.forEach(e,function(t){t.expanded=!1}),t.loaded=!0),t.fsgMaps=e,t.hideLoadingDialog()}))},e.prototype.getAllMapsList=function(){var t=this;console.log("Getting all maps..."),this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater()?this.subs.push(this.mapService.getAllFsgMapsList().flatMap(function(e){return t.fsgMaps=e,console.log("All maps:"),console.log(e),t.mapService.getUserMaps(t.fireAuth.currentUser)}).subscribe(function(e){console.log("User maps:"),console.log(e),!t.loaded&&t.fsgMaps.length>0&&e.length>0&&(t.fsgMaps=e.concat(t.fsgMaps)),t.loaded||(c.forEach(t.fsgMaps,function(t){t.expanded=!1}),t.loaded=!0),t.hideLoadingDialog()})):this.subs.push(this.mapService.getAllFsgMapsList().subscribe(function(e){console.log("Got all maps..."),t.loaded||(c.forEach(e,function(t){t.expanded=!1}),t.loaded=!0),t.fsgMaps=e,t.hideLoadingDialog()}))},e.prototype.getMapUsers=function(t){var e="";return c.forEach(t.getUsersList(),function(t){e=""+(c.isEmpty(e)?e:e+", ")+t.name}),e},e.prototype.toggleExpand=function(t,e){t.expanded=e},e.prototype.canOpenMap=function(t){return this.fireAuth.currentUser&&(t.isUser(this.fireAuth.currentUser)||this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e}(i.a);l=u([n.i(o.Component)({selector:"mapslist-component",template:n("ivJn"),styles:[n("Z2wb")]}),d("design:paramtypes",["function"==typeof(h=void 0!==s.a&&s.a)&&h||Object,"function"==typeof(f=void 0!==a.a&&a.a)&&f||Object,"function"==typeof(m=void 0!==r.a&&r.a)&&m||Object])],l);var h,f,m},"3CHR":function(t,e){t.exports='<md-toolbar [ngClass]="\'bgc-blue-grey-900 whiteText marginTopBottom-2\'">\n  <span><h3>{{title}}</h3></span>\n  <span class="fill-remaining-space"></span>\n\n  \x3c!-- <span><button md-mini-fab (click)="startMap()" *ngIf="currentMap" style="margin-right: 10px;"><md-icon>play_arrow</md-icon></button></span> --\x3e\n  \x3c!-- <span>\n    <button md-mini-fab (click)="toggleShowLocation()" style="margin-right: 10px;" >\n      <md-icon *ngIf="!showLocation">location_disabled</md-icon>\n      <md-icon *ngIf="showLocation">my_location</md-icon>\n    </button>\n  </span> --\x3e\n  <span><button md-mini-fab (click)="fitMap()" style="margin-right: 10px;" ><md-icon>pageview</md-icon></button></span>\n  <span><a md-mini-fab [routerLink]="[\'/home\']" style="margin-right: 10px;"><md-icon>home</md-icon></a></span>\n  <span><button md-mini-fab (click)="logout()" ><md-icon>exit_to_app</md-icon></button></span>\n</md-toolbar>\n\x3c!-- <md-toolbar [ngClass]="\'bgc-yellow-100 marginTopBottom-2\'" *ngIf="isAdmin()">\n  <span><md-button-toggle style="margin-right: 10px;" (change)="toggleShowInfo($event)"><md-icon>info</md-icon></md-button-toggle></span>\n  <span class="fill-remaining-space"></span>\n</md-toolbar> --\x3e\n<agm-map [latitude]="centerLat" [longitude]="centerLng" [zoom]="zoom" [ngStyle]="{\'height\': height}">\n  <marker-cluster [onFit]="onFit" [minimumClusterSize]="minimumClusterSize" [onAddressClick]="onAddressClick" [onUpdate]="mapService.onUpdate" [onSetShowClusterInfo]="onToggleShowInfo" [points]="points" ></marker-cluster>\n</agm-map>\n'},"8Sw2":function(t,e,n){function o(t){return n(r(t))}function r(t){var e=s[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var s={"./af":"FQor","./af.js":"FQor","./ar":"EcI0","./ar-dz":"cw72","./ar-dz.js":"cw72","./ar-kw":"fu+8","./ar-kw.js":"fu+8","./ar-ly":"7CVz","./ar-ly.js":"7CVz","./ar-ma":"1dFW","./ar-ma.js":"1dFW","./ar-sa":"UxV2","./ar-sa.js":"UxV2","./ar-tn":"nm31","./ar-tn.js":"nm31","./ar.js":"EcI0","./az":"EbpX","./az.js":"EbpX","./be":"SQlX","./be.js":"SQlX","./bg":"R3V+","./bg.js":"R3V+","./bn":"cAX3","./bn.js":"cAX3","./bo":"dHgA","./bo.js":"dHgA","./br":"W7ww","./br.js":"W7ww","./bs":"lZ6K","./bs.js":"lZ6K","./ca":"udbC","./ca.js":"udbC","./cs":"oSQb","./cs.js":"oSQb","./cv":"yPEm","./cv.js":"yPEm","./cy":"PpYB","./cy.js":"PpYB","./da":"oiZG","./da.js":"oiZG","./de":"LYe6","./de-at":"KOG5","./de-at.js":"KOG5","./de-ch":"o3JY","./de-ch.js":"o3JY","./de.js":"LYe6","./dv":"OkYT","./dv.js":"OkYT","./el":"QFnp","./el.js":"QFnp","./en-au":"dBGl","./en-au.js":"dBGl","./en-ca":"vv0C","./en-ca.js":"vv0C","./en-gb":"IoCy","./en-gb.js":"IoCy","./en-ie":"qVAg","./en-ie.js":"qVAg","./en-nz":"FbT0","./en-nz.js":"FbT0","./eo":"y/6j","./eo.js":"y/6j","./es":"ivpd","./es-do":"DBbP","./es-do.js":"DBbP","./es.js":"ivpd","./et":"FrUj","./et.js":"FrUj","./eu":"LAVD","./eu.js":"LAVD","./fa":"J2cK","./fa.js":"J2cK","./fi":"5FCP","./fi.js":"5FCP","./fo":"jIZb","./fo.js":"jIZb","./fr":"Lq8I","./fr-ca":"ICRA","./fr-ca.js":"ICRA","./fr-ch":"QWmo","./fr-ch.js":"QWmo","./fr.js":"Lq8I","./fy":"Fbnp","./fy.js":"Fbnp","./gd":"zhFu","./gd.js":"zhFu","./gl":"o10m","./gl.js":"o10m","./gom-latn":"UoXv","./gom-latn.js":"UoXv","./he":"gbvS","./he.js":"gbvS","./hi":"+UQz","./hi.js":"+UQz","./hr":"qGYH","./hr.js":"qGYH","./hu":"hGGh","./hu.js":"hGGh","./hy-am":"1AR5","./hy-am.js":"1AR5","./id":"Ie9h","./id.js":"Ie9h","./is":"piS+","./is.js":"piS+","./it":"5P9/","./it.js":"5P9/","./ja":"3cRe","./ja.js":"3cRe","./jv":"vwCJ","./jv.js":"vwCJ","./ka":"R7aq","./ka.js":"R7aq","./kk":"d8hV","./kk.js":"d8hV","./km":"nCdc","./km.js":"nCdc","./kn":"5K8n","./kn.js":"5K8n","./ko":"1jN3","./ko.js":"1jN3","./ky":"74/W","./ky.js":"74/W","./lb":"XAyT","./lb.js":"XAyT","./lo":"w/Mz","./lo.js":"w/Mz","./lt":"IetG","./lt.js":"IetG","./lv":"CRPd","./lv.js":"CRPd","./me":"1mee","./me.js":"1mee","./mi":"yRr3","./mi.js":"yRr3","./mk":"bfn1","./mk.js":"bfn1","./ml":"r1ky","./ml.js":"r1ky","./mr":"+K6p","./mr.js":"+K6p","./ms":"asMk","./ms-my":"IcWU","./ms-my.js":"IcWU","./ms.js":"asMk","./my":"Isng","./my.js":"Isng","./nb":"FjNp","./nb.js":"FjNp","./ne":"P9zQ","./ne.js":"P9zQ","./nl":"pejQ","./nl-be":"c3/i","./nl-be.js":"c3/i","./nl.js":"pejQ","./nn":"ALD8","./nn.js":"ALD8","./pa-in":"1YTd","./pa-in.js":"1YTd","./pl":"Gs99","./pl.js":"Gs99","./pt":"eunO","./pt-br":"uHKL","./pt-br.js":"uHKL","./pt.js":"eunO","./ro":"1FZw","./ro.js":"1FZw","./ru":"Cy48","./ru.js":"Cy48","./sd":"+28k","./sd.js":"+28k","./se":"EiHj","./se.js":"EiHj","./si":"77bI","./si.js":"77bI","./sk":"BgyH","./sk.js":"BgyH","./sl":"K7sG","./sl.js":"K7sG","./sq":"pwQJ","./sq.js":"pwQJ","./sr":"N0T2","./sr-cyrl":"9OoP","./sr-cyrl.js":"9OoP","./sr.js":"N0T2","./ss":"Mh9L","./ss.js":"Mh9L","./sv":"YZAt","./sv.js":"YZAt","./sw":"/7jV","./sw.js":"/7jV","./ta":"VKBt","./ta.js":"VKBt","./te":"TIcV","./te.js":"TIcV","./tet":"BlC1","./tet.js":"BlC1","./th":"Zi3L","./th.js":"Zi3L","./tl-ph":"D4Y9","./tl-ph.js":"D4Y9","./tlh":"muBP","./tlh.js":"muBP","./tr":"82s3","./tr.js":"82s3","./tzl":"vjXv","./tzl.js":"vjXv","./tzm":"Vhfe","./tzm-latn":"m0Pg","./tzm-latn.js":"m0Pg","./tzm.js":"Vhfe","./uk":"Y3Ex","./uk.js":"Y3Ex","./ur":"4DIg","./ur.js":"4DIg","./uz":"wDue","./uz-latn":"Li28","./uz-latn.js":"Li28","./uz.js":"wDue","./vi":"UbP6","./vi.js":"UbP6","./x-pseudo":"fQLM","./x-pseudo.js":"fQLM","./yo":"evMD","./yo.js":"evMD","./zh-cn":"DV5H","./zh-cn.js":"DV5H","./zh-hk":"iEKH","./zh-hk.js":"iEKH","./zh-tw":"X9uL","./zh-tw.js":"X9uL"};o.keys=function(){return Object.keys(s)},o.resolve=r,t.exports=o,o.id="8Sw2"},"8Vg4":function(t,e){t.exports='<div md-dialog-content>\n  <form name=\'loginFrm\' (submit)=\'login($event)\'>\n    <div class="flex-container"\n       fxLayout="column"\n       fxLayout.xs="column"\n       fxLayoutAlign="center center"\n       fxLayoutAlign.xs="start">\n       <div>\n        <div>\n          <md-input-container>\n            <label>Email</label>\n            <input mdInput type=\'email\' name="email" [(ngModel)]="email" >\n          </md-input-container>\n        </div>\n        <div>\n          <md-input-container>\n            <label>Password</label>\n            <input mdInput type=\'password\' name="password" [(ngModel)]="password" >\n          </md-input-container>\n        </div>\n        <md-dialog-actions>\n          <button md-button md-raised-button type=\'submit\' [disabled]="isPending || isMaint" >Login</button>\n        </md-dialog-actions>\n        <div>\n          {{data.consumer.errorMsg}}\n        </div>\n      </div>\n    </div>\n  </form>\n</div>\n'},APxZ:function(t,e){t.exports='<div md-dialog-content>\n  <form name=\'shareForm\'>\n    <md-card *ngIf="data.consumer.ownerMode">\n      <md-card-header>\n        <md-card-title>\n          <h4>{{data.consumer.ownerCardTitle}}</h4>\n        </md-card-title>\n        <md-card-subtitle>{{ data.consumer.ownerCardDesc }}</md-card-subtitle>\n      </md-card-header>\n      <md-card-content>\n        <tag-input [(ngModel)]="data.consumer.userList" name="ownerDlg"\n           [editable]="true" [identifyBy]="\'id\'" [displayBy]="\'name\'"\n           [maxItems]="1" [onlyFromAutocomplete]="true" [placeholder]="data.consumer.placeHolderTxt" [secondaryPlaceholder]="data.consumer.placeHolderTxt">\n           <tag-input-dropdown [appendToBody]="false" [autocompleteItems]=\'data.consumer.mapUsers\' [identifyBy]="\'$key\'" [displayBy]="\'name\'"></tag-input-dropdown>\n        </tag-input>\n        \x3c!-- <md-input-container>\n           <input type="text" mdInput name="selUser" [(ngModel)]="data.consumer.selUser"  [mdAutocomplete]="autoPub">\n        </md-input-container>\n        <md-autocomplete #autoPub="mdAutocomplete" [displayWith]="displayFn">\n           <md-option *ngFor="let mapUser of data.consumer.mapUsers" [value]="mapUser">\n             {{ mapUser.userInfoObj.name }}\n           </md-option>\n        </md-autocomplete> --\x3e\n        \x3c!-- <button md-mini-fab (click)="data.consumer.done()"><md-icon>person_add</md-icon></button> --\x3e\n      </md-card-content>\n    </md-card>\n    <md-card *ngIf="!data.consumer.ownerMode">\n      <md-card-header>\n        <md-card-title>\n          <h4>{{data.consumer.shareCardTitle}}</h4>\n        </md-card-title>\n        <md-card-subtitle>{{ data.consumer.shareCardDesc }}</md-card-subtitle>\n      </md-card-header>\n      <md-card-content>\n        <tag-input [(ngModel)]="data.consumer.userList" name="ownerDlg"\n           [editable]="true" [identifyBy]="\'id\'" [displayBy]="\'name\'" (onAdd)="data.consumer.onItemAdded($event)" (onRemove)="data.consumer.onItemAdded($event)"\n           [onlyFromAutocomplete]="true" [placeholder]="data.consumer.placeHolderTxt" [secondaryPlaceholder]="data.consumer.placeHolderTxt">\n           <tag-input-dropdown [appendToBody]="false" [autocompleteItems]=\'data.consumer.mapUsers\' [identifyBy]="\'$key\'" [displayBy]="\'name\'"></tag-input-dropdown>\n        </tag-input>\n      </md-card-content>\n    </md-card>\n  </form>\n  <md-dialog-actions>\n    <button md-mini-fab (click)="data.consumer.done()"><md-icon>save</md-icon></button>\n    <button md-mini-fab (click)="data.consumer.cancel()"><md-icon>cancel</md-icon></button>\n  </md-dialog-actions>\n  <div>\n    {{data.consumer.errorMsg}}\n  </div>\n</div>\n'},CKBp:function(t,e,n){"use strict";var o=n("/oeL"),r=n("GsmQ"),s=n("Z04r"),i=n("HGbW"),a=n("0+Pn"),c=n("Dcui"),p=n("PMtK"),u=n.n(p),d=n("xrDH");n.n(d);n.d(e,"a",function(){return g}),n.d(e,"b",function(){return b});var l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},m=this&&this.__param||function(t,e){return function(n,o){e(n,o,t)}},g=function(t){function e(e,n,o,r){var s=t.call(this)||this;return s.mapService=o,s.winRef=r,s.mapUsers=[],s.newUsersList=[],s.removeUsersList=[],s.curOwner=null,s.placeHolderTxt="Type and select name",s.ownerCardTitle="Map Owner",s.ownerCardDesc="An owner can use/share the map within 2 weeks from the time of assignment. After this time, the map will be removed from the owner's assignment list. Please reassign ownership if needed. A map can only have one owner. Removing an owner, will remove all users.",s.shareCardTitle="Map Users",s.shareCardDesc="A user will have access to the map within the day of the assignment. After this time, the map will be removed from the user's list. Please reshare again if needed.",s.ownerMode=!1,s.dialog=e,s.fireAuth=n,s}return l(e,t),e.prototype.showShareDlg=function(t){var e=this;void 0===t&&(t=!0),this.ownerMode=t,this.subs.push(this.fireAuth.getAllUsersList().subscribe(function(t){e.mapUsers=t,e.ownerMode&&e.map.hasOwner()?(e.curOwner=e.map.getOwner(),e.userList=[e.curOwner]):e.userList=e.map.getUsersList(),e.shareDlg||(e.shareDlg=e.dialog.open(b,{data:{consumer:e},disableClose:!0}))}))},e.prototype.done=function(){this.showLoadingDialog(),this.ownerMode?d.isEmpty(this.userList)?(this.mapService.removeOwner(this.map,this.curOwner),this.mapService.removeUsers(this.map,this.map.getUsersList())):(this.userList[0].expiry=u()().add(1,"week").toDate(),this.mapService.updateOwner(this.map,this.userList[0])):d.isEmpty(this.userList)?this.mapService.removeUsers(this.map,this.removeUsersList):(d.forEach(this.newUsersList,function(t){t.expiry=u()().add(1,"day").toDate()}),this.mapService.removeUsers(this.map,this.removeUsersList),this.mapService.updateUsers(this.map,this.userList)),this.closeShareDialog(),this.hideLoadingDialog()},e.prototype.cancel=function(){this.closeShareDialog()},e.prototype.closeShareDialog=function(){this.shareDlg.close(),this.shareDlg=null},e.prototype.canAssignOwner=function(){return this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater()},e.prototype.canShare=function(){return this.map.hasOwner()},e.prototype.canReturn=function(){return this.map.hasOwner()&&this.map.isOwner(this.fireAuth.currentUser)},e.prototype.returnMap=function(){this.fireAuth.currentUser.isAdmin()?(this.mapService.removeUsers(this.map,this.map.getUsersList()),this.mapService.updateUsers(this.map,[]),this.mapService.removeOwner(this.map,this.map.getOwner())):this.map.isOwner(this.fireAuth.currentUser)&&(this.mapService.removeUsers(this.map,this.map.getUsersList()),this.mapService.updateUsers(this.map,[]),this.mapService.removeOwner(this.map,this.map.getOwner()))},e.prototype.onItemAdded=function(t){this.newUsersList.push(t),d.remove(this.removeUsersList,function(e){return e.id==t.id})},e.prototype.onItemRemove=function(t){d.remove(this.newUsersList,function(e){return e.id==t.id}),this.removeUsersList.push(t)},e}(i.a);h([n.i(o.Input)(),f("design:type","function"==typeof(y=void 0!==r.b&&r.b)&&y||Object)],g.prototype,"map",void 0),g=h([n.i(o.Component)({selector:"mapshare",template:n("RvYO")}),f("design:paramtypes",["function"==typeof(v=void 0!==s.a&&s.a)&&v||Object,"function"==typeof(_=void 0!==a.a&&a.a)&&_||Object,"function"==typeof(j=void 0!==r.a&&r.a)&&j||Object,"function"==typeof(w=void 0!==c.a&&c.a)&&w||Object])],g);var b=function(){function t(t,e){this.dialogRef=t,this.data=e}return t.prototype.displayFn=function(t){return t?t.userInfoObj.name:""},t}();b=h([n.i(o.Component)({selector:"share-dlg",template:n("APxZ")}),m(1,n.i(o.Inject)(s.b)),f("design:paramtypes",["function"==typeof(M=void 0!==s.c&&s.c)&&M||Object,Object])],b);var y,v,_,j,w,M},Dcui:function(t,e,n){"use strict";var o=n("/oeL");n.d(e,"a",function(){return s});var r=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},s=function(){function t(){}return Object.defineProperty(t.prototype,"nativeWindow",{get:function(){return window},enumerable:!0,configurable:!0}),t}();s=r([n.i(o.Injectable)()],s)},GsmQ:function(t,e,n){"use strict";var o=n("/oeL"),r=n("Dqrr"),s=(n.n(r),n("xrDH")),i=(n.n(s),n("B2Lq")),a=n("PMtK"),c=n.n(a);n.d(e,"b",function(){return d}),n.d(e,"a",function(){return f});var p=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(t,e,n){this.id=t,this.mapObj=e,this.assgnObj=n,this.addressCount=s.isEmpty(e.addresses)?0:s.size(e.addresses)}return Object.defineProperty(t.prototype,"isAssigned",{get:function(){return this.assgnObj.$exists()},enumerable:!0,configurable:!0}),t.prototype.hasOwner=function(){return this.assgnObj&&this.assgnObj.$exists()&&!s.isEmpty(this.assgnObj.owner)},Object.defineProperty(t.prototype,"ownerInfo",{get:function(){return this.assgnObj.owner},enumerable:!0,configurable:!0}),t.prototype.getOwner=function(){return this.assgnObj.owner},t.prototype.setOwner=function(t){!s.isFunction(this.assgnObj.$exists)&&this.assgnObj.$exists()||(this.assgnObj={}),this.assgnObj.owner||(this.assgnObj.owner={}),this.assgnObj.owner.id=t.$key,this.assgnObj.owner.name=t.name},t.prototype.getUsersList=function(){var t=[];return s.forOwn(this.assgnObj.users,function(e,n){t.push({name:e.name,id:n,expiry:e.expiry})}),t},t.prototype.hasUsers=function(){return!s.isEmpty(this.getUsersList())},t.prototype.isOwner=function(t){return t.userInfoObj.$key==this.assgnObj.owner.id},t.prototype.isUser=function(t){var e=null!=s.find(this.getUsersList(),function(e){return e.id==t.userInfoObj.$key});return this.hasOwner()&&this.isOwner(t)||this.hasUsers()&&e},t}(),l=function(){function t(t,e){this.fsgName=t,this.maps=e}return t}(),h=function(){function t(){}return t}(),f=function(){function t(t){var e=this;this.db=t,this.onUpdate=new o.EventEmitter,this.mapMarkers=[],this.markerIdx=0,this.trackUpdates=!1,this.updatePipe=new r.Subject,this.subs=[],this.fsgs=[],this.addrStatuses=[{val:0,label:"Not Done"},{val:1,label:"Done"},{val:2,label:"Not Chinese"},{val:3,label:"Not at Home - 1"},{val:4,label:"Not at Home - 2"},{val:5,label:"Do Not Call"},{val:7,label:"Phone Witnessing"}],this.maps=[],this.updatePipe.debounceTime(5e3).subscribe(function(t){e.onUpdate.emit(t)})}return t.prototype.triggerUpdate=function(){this.onUpdate.emit({})},t.prototype.loadMapMarkersObs=function(t,e){var n=this,o={};return this.db.object("/maps/"+e).flatMap(function(t){if(t.addresses){if(!n.trackUpdates)return n.maps.push(t),o.mapObj=t,r.Observable.of(t);n.updatePipe.next({})}return r.Observable.of(null)}).filter(function(t){return null!=t}).flatMap(function(t){return n.db.object("/assignedMaps/active/"+e).flatMap(function(e){return console.log("Got assigned maps object..."),console.log(e),o.assgnObj=e,r.Observable.of(t)})}).flatMap(function(t){return n.db.list("/maps/"+e+"/addresses").flatMap(function(t){return r.Observable.from(t)})}).filter(function(t){return null!=t}).flatMap(function(t){return n.db.object("/addresses/"+t.$value)}).filter(function(t){return null!=t}).flatMap(function(t){return o.addresses||(o.addresses=[]),s.remove(o.addresses,function(e){return e.$key==t.$key}),o.addresses.push(t),r.Observable.of(t)}).flatMap(function(t){return r.Observable.of(o)}).debounce(function(){return r.Observable.interval(1e3)}).flatMap(function(t){var n=new d(e,o.mapObj,o.assgnObj);return s.forEach(o.addresses,function(t){s.forOwn(o.assgnObj.address,function(e,n){n==t.$key&&(t.status=s.toNumber(e))})}),n.addresses=o.addresses,r.Observable.of(n)})},t.prototype.createStatusMarkerIconConfig=function(t,e){return{scaledSize:t,url:"/assets/images/place-markers/status-"+e+".svg"}},t.prototype.createMarkersWithStatus=function(t){var e=this,n=new google.maps.Size(35,35),o={},r=this.createStatusMarkerIconConfig(n,403);s.forEach(this.addrStatuses,function(t){s.isEmpty(t)&&(t=0),o[t.val]=e.createStatusMarkerIconConfig(n,t.val)}),s.forEach(t.addresses,function(n){var i=null,a=n.$key;e.trackUpdates?i=s.find(e.mapMarkers,function(t){return t.addId==a}):(i=new h,i.addId=a),n.clat=s.toNumber(n.clat),n.clong=s.toNumber(n.clong),i.addObj=n,i.mapObj=t.mapObj,i.modalMode=!0;var c=r;console.log("Using status: "+n.status),n.status?c=o[n.status]:s.isEmpty(t.assgnObj.started)||(c=o[0]),console.log(c),i.marker=new google.maps.Marker({position:new google.maps.LatLng(n.clat,n.clong),icon:c}),e.trackUpdates||e.mapMarkers.push(i)})},t.prototype.loadMapMarkers=function(t,e,n){var o=this;void 0===n&&(n=!1),this.subs.push(this.db.object("/maps/"+e).subscribe(function(r){if(r.addresses){o.trackUpdates?o.updatePipe.next({}):o.maps.push(r);var i=o.markerIdx++,a=0;s.forEach(r.addresses,function(c){console.log("/addresses/"+c),o.subs.push(o.db.object("/addresses/"+c).subscribe(function(p){if(s.isEmpty(p.burb))console.log("Address not found: "+c+" in map: "+e);else{a++;var u=null;o.trackUpdates?u=s.find(o.mapMarkers,function(t){return t.addId==c}):(u=new h,u.addId=c),p.clat=s.toNumber(p.clat),p.clong=s.toNumber(p.clong),u.addObj=p,u.mapObj=r,n?u.modalMode=n:(u.url=t+"/maps/detail/"+e,u.infoWindowStr="\n                                          <div>Address: "+(-9!=p.unit?"Unit "+p.unit+",":"")+" "+p.hnum+" "+p.st+", "+p.burb+"</div>\n                                          <div>Map: <a href='"+u.url+"' target='_blank'>"+r.terId+" - "+r.name+"</a></div>\n                                          <div>FSG: "+r.fsg+"</div>\n                                        ",u.markerIdx=i),o.trackUpdates||o.mapMarkers.push(u)}}))})}else console.log("Map not found: "+e)}))},t.prototype.loadAllMapsWithMarkers=function(t){var e=this;this.subs.push(this.db.list("/fsg/list").subscribe(function(n){n.forEach(function(n){e.subs.push(e.db.list("/fsg/"+n.$value).subscribe(function(n){n.forEach(function(n){e.loadMapMarkers(t,n.$value)})}))})}))},t.prototype.clearAllMarkers=function(){s.forEach(this.subs,function(t){t.unsubscribe()}),this.subs.length=0,this.maps.length=0,this.mapMarkers.length=0,this.trackUpdates=!1,this.triggerUpdate()},t.prototype.getAllFsgMaps=function(t){var e=this;return this.fsgs.length=0,this.db.list("/fsg/list").flatMap(function(t){return r.Observable.from(t)}).flatMap(function(n){var o=n.$value;return e.db.list("/fsg/"+o).flatMap(function(e){return e.forEach(function(e){t[e.$value]={fsgName:o}}),r.Observable.from(e)})})},t.prototype.getAllFsgMapsList=function(){var t=this,e={};return this.getAllFsgMaps(e).flatMap(function(e){return t.db.object("/maps/"+e.$value)}).flatMap(function(n){return e[n.$key].mapObj=n,t.db.object("/assignedMaps/active/"+n.$key).flatMap(function(t){return e[n.$key].assgnObj=t,r.Observable.of(n)})}).flatMap(function(t){return r.Observable.of(e)}).debounce(function(){return r.Observable.interval(1e3)}).flatMap(function(n){return s.forOwn(e,function(e,n){var o=s.find(t.fsgs,function(t){return t.fsgName==e.fsgName});o||(o=new l(e.fsgName,[]),t.fsgs.push(o));var r=s.find(o.maps,function(t){return t.id==n});r?(r.mapObj=e.mapObj,r.assgnObj=e.assgnObj):o.maps.push(new d(n,e.mapObj,e.assgnObj))}),r.Observable.of(t.fsgs)})},t.prototype.getUserMaps=function(t){var e=this,n={};return this.db.object("/users/"+t.userInfoObj.$key+"/maps").flatMap(function(t){if(console.log("Got user maps list..."),e.fsgs=[],t.$exists()){var n=[];return s.forOwn(t,function(t,e){n.push(e)}),r.Observable.from(n)}return r.Observable.of(null)}).flatMap(function(t){return console.log("Got map id...."),e.fsgs.length=0,t?e.db.object("/maps/"+t):r.Observable.of(null)}).flatMap(function(t){return console.log("Got map obj...."),e.fsgs.length=0,t?(s.isEmpty(n[t.$key])&&(n[t.$key]={fsgName:"Your Maps"}),n[t.$key].mapObj=t,e.db.object("/assignedMaps/active/"+t.$key).flatMap(function(e){return n[t.$key].assgnObj=e,r.Observable.of(t)})):r.Observable.of(null)}).flatMap(function(t){return r.Observable.of(n)}).debounce(function(){return r.Observable.interval(1e3)}).flatMap(function(t){console.log(e.fsgs);return s.forOwn(n,function(t,n){var o=s.find(e.fsgs,function(e){return e.fsgName==t.fsgName});o||(o=new l(t.fsgName,[]),e.fsgs.push(o));var r=s.find(o.maps,function(t){return t.id==n});r?(r.mapObj=t.mapObj,r.assgnObj=t.assgnObj):o.maps.push(new d(n,t.mapObj,t.assgnObj))}),r.Observable.of(e.fsgs)})},t.prototype.updateOwner=function(t,e){var n={};s.forEach(),n["/assignedMaps/active/"+t.id]={owner:{id:e.id,name:e.name,expiry:e.expiry},expiry:e.expiry,started:c()().toDate()},n["/users/"+e.id+"/maps/"+t.id+"/expiry"]=e.expiry,this.db.database.ref().update(n)},t.prototype.updateUsers=function(t,e){var n={},o={};s.forEach(e,function(e){o[e.id]={name:e.name,expiry:e.expiry},n["/users/"+e.id+"/maps/"+t.id+"/expiry"]=e.expiry}),n["/assignedMaps/active/"+t.id+"/users"]=o,console.log(n),this.db.database.ref().update(n)},t.prototype.removeOwner=function(t,e){var n={};n["/assignedMaps/active/"+t.id+"/owner"]=null,n["/assignedMaps/active/"+t.id+"/expiry"]=null,n["/users/"+e.id+"/maps/"+t.id]=null,this.db.database.ref().update(n)},t.prototype.removeUsers=function(t,e){var n={};s.forEach(e,function(e){n["/users/"+e.id+"/maps/"+t.id]=null}),this.db.database.ref().update(n)},t.prototype.updateAddrStat=function(t,e,n,o){void 0===o&&(o=null);var r={};r["/assignedMaps/active/"+t+"/address/"+e]=n,this.db.database.ref().update(r).then(function(){o&&o()})},t}();p([n.i(o.Output)(),u("design:type",Object)],f.prototype,"onUpdate",void 0),f=p([n.i(o.Injectable)(),u("design:paramtypes",["function"==typeof(m=void 0!==i.a&&i.a)&&m||Object])],f);var m},HGbW:function(t,e,n){"use strict";var o=n("hoZb"),r=n("xrDH"),s=(n.n(r),n("+tBu"));n.d(e,"a",function(){return i});var i=function(){function t(){this.subs=[]}return t.prototype.showLoadingDialog=function(){this.loadingDialog=this.dialog.open(o.a,{disableClose:!0})},t.prototype.hideLoadingDialog=function(){this.loadingDialog&&this.loadingDialog.close()},t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){this.unsubscribeAll()},t.prototype.unsubscribeAll=function(){r.forEach(this.subs,function(t){t.unsubscribe()})},t.prototype.requireLogin=function(){var t=this;this.subs.push(this.fireAuth.getUserObs().subscribe(function(e){e?(t.loginDiag&&t.loginDiag.close(),t.fireAuth.currentUser?t.postLoginSetup():(t.fireAuth.getAllUserInfo(),t.subs.push(t.fireAuth.onCurrentUserInfo.subscribe(function(e){t.postLoginSetup()})))):t.loginDiag=t.dialog.open(s.a,{data:{consumer:t},disableClose:!0})}))},t.prototype.postLoginSetup=function(){console.log("BaseComponent post login, doing nothing.")},t.prototype.login=function(t){var e=this;this.errorMsg="",console.log("BaseComponent logging in: "),console.log(t),this.showLoadingDialog(),this.fireAuth.login(t.email,t.password).then(function(t){e.hideLoadingDialog()}).catch(function(t){e.hideLoadingDialog(),console.log(t);var n=t.message;e.errorMsg=n})},t.prototype.logout=function(){this.fireAuth.logout()},t}()},HbVw:function(t,e,n){"use strict";var o=n("fc+i"),r=n("/oeL"),s=n("13je"),i=n("B2Lq"),a=n("8k1a"),c=n("p5Ee"),p=n("0+Pn"),u=n("mPw8");n.d(e,"a",function(){return l});var d=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},l=function(){function t(){}return t}();l=d([n.i(r.NgModule)({imports:[o.a,s.a.initializeApp(c.a.firebase),i.b,a.b],exports:[u.a],declarations:[u.a],bootstrap:[],providers:[p.a]})],l)},Iqat:function(t,e,n){"use strict";var o=n("/oeL"),r=n("BkNc"),s=n("SAdc"),i=n("wINU");n.d(e,"a",function(){return p});var a=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},c=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:s.a},{path:"map/:id",component:i.a}],p=function(){function t(){}return t}();p=a([n.i(o.NgModule)({imports:[r.a.forRoot(c)],exports:[r.a]})],p);s.a,i.a},KJMk:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},MnZv:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},RvYO:function(t,e){t.exports='<button md-mini-fab (click)="showShareDlg(true)" *ngIf="canAssignOwner()"><md-icon>assignment_ind</md-icon></button>\n<button md-mini-fab (click)="showShareDlg(false)" *ngIf="canShare()"><md-icon>share</md-icon></button>\n<button md-mini-fab (click)="returnMap()" *ngIf="canReturn()"><md-icon>assignment_return</md-icon></button>\n'},SAdc:function(t,e,n){"use strict";var o=n("/oeL"),r=n("0+Pn"),s=n("Z04r"),i=n("0o1w"),a=n("HGbW");n.d(e,"a",function(){return d});var c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(t){function e(e,n){var o=t.call(this)||this;return o.dialog=n,o.fireAuth=e,o.errorMsg=o.fireAuth.currentUser?"":"Please login.",o.requireLogin(),o}return c(e,t),e.prototype.postLoginSetup=function(){console.log("Home Component Post Login"),this.mapListComp.load()},e.prototype.canViewAllMaps=function(){return this.fireAuth.currentUser&&(this.fireAuth.currentUser.isAdmin()||this.fireAuth.currentUser.isUpdater())},e}(a.a);p([n.i(o.ViewChild)("myMapsList"),u("design:type","function"==typeof(l=void 0!==i.a&&i.a)&&l||Object)],d.prototype,"mapListComp",void 0),d=p([n.i(o.Component)({selector:"home-component",template:n("zgAq"),styles:[n("MnZv")]}),u("design:paramtypes",["function"==typeof(h=void 0!==r.a&&r.a)&&h||Object,"function"==typeof(f=void 0!==s.a&&s.a)&&f||Object])],d);var l,h,f},SicF:function(t,e){t.exports='<span *ngIf="user && user.userObj"><h3>{{user?.userInfoObj?.name}}</h3></span>\n'},"Xir+":function(t,e){/**
 * @license
 * Copyright 2010 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function n(t,e,o){this.extend(n,google.maps.OverlayView),this.map_=t,this.showInfo=!1,this.markers_=[],this.clusters_=[],this.sizes=[53,56,66,78,90],this.styles_=[],this.ready_=!1;var r=o||{};this.gridSize_=r.gridSize||60,this.minClusterSize_=r.minimumClusterSize||2,this.maxZoom_=r.maxZoom||null,this.styles_=r.styles||[],this.imagePath_=r.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=r.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,void 0!=r.zoomOnClick&&(this.zoomOnClick_=r.zoomOnClick),this.averageCenter_=!1,void 0!=r.averageCenter&&(this.averageCenter_=r.averageCenter),this.setupStyles_(),this.setMap(t),this.prevZoom_=this.map_.getZoom();var s=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var t=s.map_.getZoom();s.prevZoom_!=t&&(s.prevZoom_=t,s.resetViewport())}),google.maps.event.addListener(this.map_,"idle",function(){s.redraw()}),e&&e.length&&this.addMarkers(e,!1)}function o(t){this.markerClusterer_=t,this.map_=t.getMap(),this.gridSize_=t.getGridSize(),this.minClusterSize_=t.getMinClusterSize(),this.averageCenter_=t.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new r(this,t.getStyles(),t.getGridSize()),this.infoWindowStr=null}function r(t,e,n,o){t.getMarkerClusterer().extend(r,google.maps.OverlayView),this.styles_=e,this.padding_=n||0,this.cluster_=t,this.center_=null,this.map_=t.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.infowindow=null,this.showInfo=o,this.setMap(this.map_)}n.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m",n.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",n.prototype.extend=function(t,e){return function(t){for(var e in t.prototype)this.prototype[e]=t.prototype[e];return this}.apply(t,[e])},n.prototype.onAdd=function(){this.setReady_(!0)},n.prototype.draw=function(){},n.prototype.setupStyles_=function(){if(!this.styles_.length)for(var t,e=0;t=this.sizes[e];e++)this.styles_.push({url:this.imagePath_+(e+1)+"."+this.imageExtension_,height:t,width:t})},n.prototype.fitMapToMarkers=function(){for(var t,e=this.getMarkers(),n=new google.maps.LatLngBounds,o=0;t=e[o];o++)n.extend(t.getPosition());this.map_.fitBounds(n)},n.prototype.setStyles=function(t){this.styles_=t},n.prototype.getStyles=function(){return this.styles_},n.prototype.isZoomOnClick=function(){return this.zoomOnClick_},n.prototype.isAverageCenter=function(){return this.averageCenter_},n.prototype.getMarkers=function(){return this.markers_},n.prototype.getTotalMarkers=function(){return this.markers_.length},n.prototype.setMaxZoom=function(t){this.maxZoom_=t},n.prototype.getMaxZoom=function(){return this.maxZoom_},n.prototype.calculator_=function(t,e){for(var n=0,o=t.length,r=o;0!==r;)r=parseInt(r/10,10),n++;return n=Math.min(n,e),{text:o,index:n}},n.prototype.setCalculator=function(t){this.calculator_=t},n.prototype.getCalculator=function(){return this.calculator_},n.prototype.addMarkers=function(t,e){for(var n,o=0;n=t[o];o++)this.pushMarkerTo_(n);e||this.redraw()},n.prototype.pushMarkerTo_=function(t){if(t.isAdded=!1,t.draggable){var e=this;google.maps.event.addListener(t,"dragend",function(){t.isAdded=!1,e.repaint()})}this.markers_.push(t)},n.prototype.addMarker=function(t,e){this.pushMarkerTo_(t),e||this.redraw()},n.prototype.removeMarker_=function(t){var e=-1;if(this.markers_.indexOf)e=this.markers_.indexOf(t);else for(var n,o=0;n=this.markers_[o];o++)if(n==t){e=o;break}return-1!=e&&(t.setMap(null),this.markers_.splice(e,1),!0)},n.prototype.removeMarker=function(t,e){var n=this.removeMarker_(t);return!(e||!n)&&(this.resetViewport(),this.redraw(),!0)},n.prototype.removeMarkers=function(t,e){for(var n,o=!1,r=0;n=t[r];r++){var s=this.removeMarker_(n);o=o||s}if(!e&&o)return this.resetViewport(),this.redraw(),!0},n.prototype.setReady_=function(t){this.ready_||(this.ready_=t,this.createClusters_())},n.prototype.getTotalClusters=function(){return this.clusters_.length},n.prototype.getMap=function(){return this.map_},n.prototype.setMap=function(t){this.map_=t},n.prototype.getGridSize=function(){return this.gridSize_},n.prototype.setGridSize=function(t){this.gridSize_=t},n.prototype.getMinClusterSize=function(){return this.minClusterSize_},n.prototype.setMinClusterSize=function(t){this.minClusterSize_=t},n.prototype.getExtendedBounds=function(t){var e=this.getProjection(),n=new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()),o=new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()),r=e.fromLatLngToDivPixel(n);r.x+=this.gridSize_,r.y-=this.gridSize_;var s=e.fromLatLngToDivPixel(o);s.x-=this.gridSize_,s.y+=this.gridSize_;var i=e.fromDivPixelToLatLng(r),a=e.fromDivPixelToLatLng(s);return t.extend(i),t.extend(a),t},n.prototype.isMarkerInBounds_=function(t,e){return e.contains(t.getPosition())},n.prototype.clearMarkers=function(){this.hideAllClusterInfo(),this.resetViewport(!0),this.markers_=[]},n.prototype.resetViewport=function(t){this.hideAllClusterInfo();for(var e,n=0;e=this.clusters_[n];n++)e.remove();for(var o,n=0;o=this.markers_[n];n++)o.isAdded=!1,t&&o.setMap(null);this.clusters_=[]},n.prototype.repaint=function(){var t=this.clusters_.slice();this.clusters_.length=0,this.resetViewport(),this.redraw(),window.setTimeout(function(){for(var e,n=0;e=t[n];n++)e.remove()},0)},n.prototype.redraw=function(){this.createClusters_()},n.prototype.distanceBetweenPoints_=function(t,e){if(!t||!e)return 0;var n=(e.lat()-t.lat())*Math.PI/180,o=(e.lng()-t.lng())*Math.PI/180,r=Math.sin(n/2)*Math.sin(n/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(e.lat()*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371},n.prototype.addToClosestCluster_=function(t){for(var e,n=4e4,r=null,s=(t.getPosition(),0);e=this.clusters_[s];s++){var i=e.getCenter();if(i){var a=this.distanceBetweenPoints_(i,t.getPosition());a<n&&(n=a,r=e)}}if(r&&r.isMarkerInClusterBounds(t))r.addMarker(t);else{var e=new o(this);e.setShowInfo(this.showInfo),e.addMarker(t),this.clusters_.push(e)}},n.prototype.createClusters_=function(){if(this.ready_)for(var t,e=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),n=this.getExtendedBounds(e),o=0;t=this.markers_[o];o++)!t.isAdded&&this.isMarkerInBounds_(t,n)&&this.addToClosestCluster_(t)},n.prototype.hideAllClusterInfo=function(){for(var t,e=0;t=this.clusters_[e];e++)t.closeAllInfo()},n.prototype.setShowInfo=function(t){this.showInfo=t;for(var e,n=0;e=this.clusters_[n];n++)e.setShowInfo(t),t||e.closeAllInfo()},o.prototype.closeAllInfo=function(){this.clusterIcon_.closeAllInfo()},o.prototype.setShowInfo=function(t){this.clusterIcon_.showInfo=t},o.prototype.isMarkerAlreadyAdded=function(t){if(this.markers_.indexOf)return-1!=this.markers_.indexOf(t);for(var e,n=0;e=this.markers_[n];n++)if(e==t)return!0;return!1},o.prototype.addMarker=function(t){if(this.isMarkerAlreadyAdded(t))return!1;if(this.center_){if(this.averageCenter_){var e=this.markers_.length+1,n=(this.center_.lat()*(e-1)+t.getPosition().lat())/e,o=(this.center_.lng()*(e-1)+t.getPosition().lng())/e;this.center_=new google.maps.LatLng(n,o),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();t.isAdded=!0,this.markers_.push(t);var r=this.markers_.length;if(r<this.minClusterSize_&&t.getMap()!=this.map_&&t.setMap(this.map_),r==this.minClusterSize_)for(var s=0;s<r;s++)this.markers_[s].setMap(null);return r>=this.minClusterSize_&&t.setMap(null),this.updateIcon(),this.infoWindowStr=(this.infoWindowStr?this.infoWindowStr+"<hr>":"")+t.infoWindowStr,!0},o.prototype.getMarkerClusterer=function(){return this.markerClusterer_},o.prototype.getBounds=function(){for(var t,e=new google.maps.LatLngBounds(this.center_,this.center_),n=this.getMarkers(),o=0;t=n[o];o++)e.extend(t.getPosition());return e},o.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},o.prototype.getSize=function(){return this.markers_.length},o.prototype.getMarkers=function(){return this.markers_},o.prototype.getCenter=function(){return this.center_},o.prototype.calculateBounds_=function(){var t=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(t)},o.prototype.isMarkerInClusterBounds=function(t){return this.bounds_.contains(t.getPosition())},o.prototype.getMap=function(){return this.map_},o.prototype.updateIcon=function(){var t=this.map_.getZoom(),e=this.markerClusterer_.getMaxZoom();if(e&&t>e)for(var n,o=0;n=this.markers_[o];o++)n.setMap(this.map_);else{if(this.markers_.length<this.minClusterSize_)return void this.clusterIcon_.hide();var r=this.markerClusterer_.getStyles().length,s=this.markerClusterer_.getCalculator()(this.markers_,r);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(s),this.clusterIcon_.show()}},r.prototype.triggerClusterClick=function(t){var e=this.cluster_.getMarkerClusterer();google.maps.event.trigger(e,"clusterclick",this.cluster_,t),e.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds())},r.prototype.onAdd=function(){if(this.div_=document.createElement("DIV"),this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(t),this.div_.innerHTML=this.sums_.text}this.getPanes().overlayMouseTarget.appendChild(this.div_);var e=this,n=!1;google.maps.event.addDomListener(this.div_,"click",function(t){n||e.triggerClusterClick(t)}),google.maps.event.addDomListener(this.div_,"mousedown",function(){n=!1}),google.maps.event.addDomListener(this.div_,"mousemove",function(){n=!0}),this.infowindow=new google.maps.InfoWindow({content:"<div id='info-window'>"+this.cluster_.infoWindowStr+"</div>"});var o=this.map_,r=this.center_,s=this.infowindow;this.showInfo;google.maps.event.addDomListener(this.div_,"mouseover",function(){e.showInfo&&(s.setPosition(r),s.open(o))})},r.prototype.closeAllInfo=function(){this.infowindow&&this.infowindow.close(this.map_)},r.prototype.getPosFromLatLng_=function(t){var e=this.getProjection().fromLatLngToDivPixel(t);return"object"==typeof this.iconAnchor_&&2===this.iconAnchor_.length?(e.x-=this.iconAnchor_[0],e.y-=this.iconAnchor_[1]):(e.x-=parseInt(this.width_/2,10),e.y-=parseInt(this.height_/2,10)),e},r.prototype.draw=function(){if(this.visible_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.top=t.y+"px",this.div_.style.left=t.x+"px"}},r.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},r.prototype.show=function(){if(this.div_){var t=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(t),this.div_.style.display=""}this.visible_=!0},r.prototype.remove=function(){this.setMap(null)},r.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},r.prototype.setSums=function(t){this.sums_=t,this.text_=t.text,this.index_=t.index,this.div_&&(this.div_.innerHTML=t.text),this.useStyle()},r.prototype.useStyle=function(){var t=Math.max(0,this.sums_.index-1);t=Math.min(this.styles_.length-1,t);var e=this.styles_[t];this.url_=e.url,this.height_=e.height,this.width_=e.width,this.textColor_=e.textColor,this.anchor_=e.anchor,this.textSize_=e.textSize,this.backgroundPosition_=e.backgroundPosition,this.iconAnchor_=e.iconAnchor},r.prototype.setCenter=function(t){this.center_=t},r.prototype.createCss=function(t){var e=[];e.push("background-image:url("+this.url_+");");var n=this.backgroundPosition_?this.backgroundPosition_:"0 0";e.push("background-position:"+n+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?e.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):"number"==typeof this.anchor_[0]&&this.anchor_[0]<0&&-this.anchor_[0]<this.height_?e.push("height:"+this.height_+"px; line-height:"+(this.height_+this.anchor_[0])+"px;"):e.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?e.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):e.push("width:"+this.width_+"px; text-align:center;")):e.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var o=this.textColor_?this.textColor_:"black",r=this.textSize_?this.textSize_:11;return e.push("cursor:pointer; top:"+t.y+"px; left:"+t.x+"px; color:"+o+"; position:absolute; font-size:"+r+"px; font-family:Arial,sans-serif; font-weight:bold"),e.join("")},window.MarkerClusterer=n,n.prototype.addMarker=n.prototype.addMarker,n.prototype.addMarkers=n.prototype.addMarkers,n.prototype.clearMarkers=n.prototype.clearMarkers,n.prototype.fitMapToMarkers=n.prototype.fitMapToMarkers,n.prototype.getCalculator=n.prototype.getCalculator,n.prototype.getGridSize=n.prototype.getGridSize,n.prototype.getExtendedBounds=n.prototype.getExtendedBounds,n.prototype.getMap=n.prototype.getMap,n.prototype.getMarkers=n.prototype.getMarkers,n.prototype.getMaxZoom=n.prototype.getMaxZoom,n.prototype.getStyles=n.prototype.getStyles,n.prototype.getTotalClusters=n.prototype.getTotalClusters,n.prototype.getTotalMarkers=n.prototype.getTotalMarkers,n.prototype.redraw=n.prototype.redraw,n.prototype.removeMarker=n.prototype.removeMarker,n.prototype.removeMarkers=n.prototype.removeMarkers,n.prototype.resetViewport=n.prototype.resetViewport,n.prototype.repaint=n.prototype.repaint,n.prototype.setCalculator=n.prototype.setCalculator,n.prototype.setGridSize=n.prototype.setGridSize,n.prototype.setMaxZoom=n.prototype.setMaxZoom,n.prototype.onAdd=n.prototype.onAdd,n.prototype.draw=n.prototype.draw,n.prototype.hideAllClusterInfo=n.prototype.hideAllClusterInfo,n.prototype.setShowInfo=n.prototype.setShowInfo,o.prototype.getCenter=o.prototype.getCenter,o.prototype.getSize=o.prototype.getSize,o.prototype.getMarkers=o.prototype.getMarkers,o.prototype.closeAllInfo=o.prototype.closeAllInfo,o.prototype.setShowInfo=o.prototype.setShowInfo,r.prototype.onAdd=r.prototype.onAdd,r.prototype.draw=r.prototype.draw,r.prototype.onRemove=r.prototype.onRemove,r.prototype.closeAllInfo=r.prototype.closeAllInfo},"Z/XM":function(t,e){t.exports='<div md-dialog-content>\n  <form name=\'addrForm\'>\n    <md-card *ngIf="data.consumer.mapStarted">\n      <md-card-content>\n        <span><h3>{{ data.consumer.currentAddrTitle }} </h3></span>\n        <md-radio-group class="addrstat-radio-group" name="stat" [(ngModel)]="data.consumer.currentAddr.addObj.status">\n          <md-radio-button class="addrstat-radio-button" *ngFor="let stat of data.consumer.mapService.addrStatuses" [value]="stat.val">\n            {{ stat.label }}\n          </md-radio-button>\n        </md-radio-group>\n        \x3c!-- <md-button-toggle-group name="status" [vertical]="true" color="accent" (change)="data.consumer.onStatusChange($event)">\n          <md-button-toggle value="1">\n            Done\n          </md-button-toggle>\n          <md-button-toggle value="2">\n            Not at Home - 1\n          </md-button-toggle>\n          <md-button-toggle value="3" >\n            Not at Home - 2\n          </md-button-toggle>\n          <md-button-toggle value="4" >\n            Not Chinese\n          </md-button-toggle>\n          <md-button-toggle value="5" >\n            Do not call\n          </md-button-toggle>\n          <md-button-toggle value="4" >\n            Phone Witnessing\n          </md-button-toggle>\n        </md-button-toggle-group> --\x3e\n        \x3c!-- <md-list>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Done </button>\n          </md-list-item>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Not at Home - 1 </button>\n          </md-list-item>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Not at Home - 2 </button>\n          </md-list-item>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Not Chinese </button>\n          </md-list-item>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Do not call </button>\n          </md-list-item>\n          <md-list-item>\n            <button md-raised-button color="accent" style="width: 150px;"> Phone Witnessing </button>\n          </md-list-item>\n        </md-list> --\x3e\n      </md-card-content>\n      <md-card-actions>\n        <button md-fab (click)="data.consumer.saveStatus()"><md-icon>done</md-icon></button>\n        <a target="_blank" href="{{ data.consumer.currentGmapUrl }}" md-fab ><md-icon svgIcon="google-map"></md-icon></a>\n        <button md-fab (click)="data.consumer.closeAddrDlg()"><md-icon>cancel</md-icon></button>\n      </md-card-actions>\n    </md-card>\n    <md-card *ngIf="!data.consumer.mapStarted">\n      <md-card-content>\n        <span><h3>{{ data.consumer.currentAddrTitle }} </h3></span>\n        <div>\n            Please ask any map updaters to assign this map to an owner.\n        </div>\n      </md-card-content>\n      <md-card-actions>\n        \x3c!-- <button md-fab *ngIf="data.consumer.currentMap" (click)="data.consumer.startMap()" ><md-icon>play_arrow</md-icon></button> --\x3e\n        <a target="_blank" href="{{ data.consumer.currentGmapUrl }}" md-fab ><md-icon svgIcon="google-map"></md-icon></a>\n        <button md-fab (click)="data.consumer.closeAddrDlg()"><md-icon>cancel</md-icon></button>\n      </md-card-actions>\n    </md-card>\n  </form>\n</div>\n'},Z2wb:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,".mapCard{margin-top:10px;margin-bottom:10px}",""]),t.exports=t.exports.toString()},aHcY:function(t,e,n){"use strict";var o=n("/oeL"),r=n("a0oU"),s=n("wINU"),i=n("0o1w"),a=n("qbdv"),c=n("bm2B"),p=n("GsmQ"),u=n("B2Lq"),d=n("hoZb"),l=n("xwLn"),h=n("Z04r"),f=n("Htvr"),m=n("BkNc"),g=n("HbVw"),b=n("Dcui"),y=n("CKBp"),v=n("cn2Z"),_=(n.n(v),n("fL27")),j=n("CPp0");n.d(e,"a",function(){return M});var w=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},M=function(){function t(){}return t}();M=w([n.i(o.NgModule)({imports:[a.CommonModule,c.FormsModule,_.a,v.TagInputModule,r.a.forRoot({apiKey:"AIzaSyB6EVRDfSAHTAkrx-VmXyKU7Y3qLSuD0Ag"}),u.b,h.k,h.l,h.i,h.m,h.n,h.e,h.j,h.o,h.g,h.p,h.q,h.h,h.r,j.b,m.a,f.a,g.a],declarations:[s.a,i.a,l.a,d.a,y.a,y.b,s.b],exports:[s.a,i.a,l.a,y.a,y.b,s.b],providers:[p.a,b.a],entryComponents:[d.a,y.b,s.b]})],M)},"aR8+":function(t,e,n){"use strict";var o=n("fc+i"),r=n("/oeL"),s=n("fL27"),i=n("Iqat"),a=n("rgUS"),c=(n.n(a),n("wQAS")),p=n("ktAp");n.d(e,"a",function(){return d});var u=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},d=function(){function t(){}return t}();d=u([n.i(r.NgModule)({declarations:[c.a],imports:[o.a,s.a,p.a,i.a],providers:[],bootstrap:[c.a]})],d)},cDNt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("/oeL"),r=n("Qa4U"),s=n("aR8+");n("p5Ee").a.production&&n.i(o.enableProdMode)(),n.i(r.a)().bootstrapModule(s.a)},dCN4:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},efyd:function(t,e){t.exports='\x3c!--The whole content below can be removed with the new code.--\x3e\n<div style="text-align:center">\n  <h1>\n    Macgregor Maps 2.2\n  </h1>\n</div>\n<div mat-app-background>\n  <router-outlet></router-outlet>\n</div>\n'},hoZb:function(t,e,n){"use strict";var o=n("Z04r"),r=n("/oeL");n.d(e,"a",function(){return a});var s=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=function(){function t(t){this.dialogRef=t}return t}();a=s([n.i(r.Component)({selector:"loading-dialog",template:'\n            <div md-dialog-content>\n              <div class="flex-container"\n               fxLayout="column"\n               fxLayout.xs="column"\n               fxLayoutAlign="center center"\n               fxLayoutAlign.xs="start">\n                  <img src="/assets/images/pie-loader.svg">\n               </div>\n            </div>\n            '}),i("design:paramtypes",["function"==typeof(c=void 0!==o.c&&o.c)&&c||Object])],a);var c},hxJY:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,"*{font-family:Roboto,sans-serif}",""]),t.exports=t.exports.toString()},ivJn:function(t,e){t.exports='<td-expansion-panel *ngFor="let fsg of fsgMaps" (expanded)="toggleExpand(fsg, true)" (collapsed)="toggleExpand(fsg, false)">\n  <ng-template td-expansion-panel-header>\n    <md-toolbar [ngClass]="\'bgc-blue-grey-600 whiteText marginTopBottom-2\'">\n      <span><h2>{{fsg.fsgName}}</h2> </span>\n      <span class="fill-remaining-space"></span>\n      <span><md-icon *ngIf="!fsg.expanded">keyboard_arrow_down</md-icon><md-icon *ngIf="fsg.expanded">keyboard_arrow_up</md-icon></span>\n    </md-toolbar>\n  </ng-template>\n  <md-card class=\'mapCard\' *ngFor="let map of fsg.maps">\n    <md-card-header>\n      <md-card-title>\n        <h3>\n          {{map.mapObj.terId}} - {{map.mapObj.name}}\n        </h3>\n      </md-card-title>\n    </md-card-header>\n    <md-card-content>\n      <md-chip-list selectable="false">\n        \x3c!-- <md-chip >Completion Status: </md-chip> --\x3e\n        <md-chip *ngIf="map.assgnObj && map.assgnObj.started">Started: {{ map.assgnObj.started | date:\'dd MMM y\'}}</md-chip>\n        <md-chip *ngIf="map.assgnObj && map.assgnObj.expiry">Expiry: {{ map.assgnObj.expiry | date:\'dd MMM y\'}}</md-chip>\n        <md-chip *ngIf="map.hasOwner()">Owner: {{ map.getOwner().name}} </md-chip>\n        <md-chip *ngIf="map.hasUsers()">Users: {{ getMapUsers(map) }}</md-chip>\n        <md-chip>Last completed: {{ map.mapObj.lastCompleted | date:\'dd MMM y\'}}</md-chip>\n        <md-chip>Addresses: {{map.addressCount}}</md-chip>\n      </md-chip-list>\n    </md-card-content>\n    <md-card-actions>\n      <a *ngIf="canOpenMap(map)" md-mini-fab [routerLink]="[\'/map\', map.id]"><md-icon>map</md-icon></a>\n      <mapshare [map]="map"></mapshare>\n    </md-card-actions>\n  </md-card>\n</td-expansion-panel>\n'},ktAp:function(t,e,n){"use strict";var o=n("qbdv"),r=n("/oeL"),s=n("bm2B"),i=n("Z04r"),a=n("SAdc"),c=n("+tBu"),p=n("HbVw"),u=n("aHcY"),d=n("b9Zm"),l=n("BkNc");n.d(e,"a",function(){return f});var h=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},f=function(){function t(){}return t}();f=h([n.i(r.NgModule)({imports:[o.CommonModule,s.FormsModule,i.e,i.f,i.g,i.h,i.i,i.j,d.a,i.k,p.a,u.a,l.a],declarations:[a.a,c.a],exports:[o.CommonModule,s.FormsModule,u.a,a.a,c.a,p.a],providers:[],entryComponents:[c.a]})],f)},mPw8:function(t,e,n){"use strict";var o=n("/oeL"),r=n("0+Pn"),s=n("HGbW");n.d(e,"a",function(){return p});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(t){function e(e){var n=t.call(this)||this;return n.fireAuth=e,n.subs=[],n}return i(e,t),e.prototype.ngOnInit=function(){var t=this;this.user=this.fireAuth.currentUser,this.subs.push(this.fireAuth.onCurrentUserInfo.subscribe(function(e){t.user=t.fireAuth.currentUser,console.log("User info:"),console.log(t.user)}))},e}(s.a);p=a([n.i(o.Component)({selector:"userinfo",template:n("SicF")}),c("design:paramtypes",["function"==typeof(u=void 0!==r.a&&r.a)&&u||Object])],p);var u},n7du:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="n7du"},p5Ee:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o={production:!0,app:{mapBase:"https://macgregor.jwapp.xyz/#"},firebase:{apiKey:"AIzaSyCjArW7DreGKLfBes3RXS_-z9B1ICQX5KE",authDomain:"congmap-prod.firebaseapp.com",databaseURL:"https://congmap-prod.firebaseio.com",projectId:"congmap-prod",storageBucket:"congmap-prod.appspot.com",messagingSenderId:"232314776603"}}},wINU:function(t,e,n){"use strict";var o=n("/oeL"),r=n("GsmQ"),s=n("Dqrr"),i=(n.n(s),n("p5Ee")),a=n("Z04r"),c=n("xrDH"),p=(n.n(c),n("BkNc")),u=n("Dcui"),d=n("HGbW"),l=n("0+Pn"),h=n("fc+i");n.d(e,"a",function(){return y}),n.d(e,"b",function(){return v});var f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},g=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},b=this&&this.__param||function(t,e){return function(n,o){e(n,o,t)}},y=function(t){function e(e,n,r,s,i){var a=t.call(this)||this;return a.mapService=e,a.route=s,a.winRef=i,a.currentLocation={addObj:{clat:null,clang:null},iconUrl:"/assets/images/ic_my_location_red_24px.svg",pushed:!1},a.points=[],a.centerLat=-27.5518075,a.centerLng=153.0807544,a.zoom=13,a.height="700px",a.maxWaitTries=20,a.maxWaitCtr=0,a.sameCtr=0,a.sameMax=10,a.checkInterval=1e3,a.showInfo=!1,a.onToggleShowInfo=new o.EventEmitter,a.onComplete=new o.EventEmitter,a.onAddressClick=new o.EventEmitter,a.onFit=new o.EventEmitter,a.minimumClusterSize=2,a.shortenTitleWidth=1024,a.triggerUpdate=!1,a.mapStarted=!1,a.showLocation=!1,a.dialog=n,a.fireAuth=r,a.requireLogin(),a}return f(e,t),e.prototype.postLoginSetup=function(){var t=this;console.log(this.winRef.nativeWindow.innerHeight),this.height=this.winRef.nativeWindow.innerHeight-180+"px",this.title="Loading...",this.subs.push(this.route.params.subscribe(function(e){t.mapId=e.id,t.loadMaps()}))},e.prototype.ngOnDestroy=function(){this.clearMaps(),this.unsubscribeAll()},e.prototype.toggleShowInfo=function(){this.showInfo=!this.showInfo,console.log("Emitting: "+this.showInfo),this.onToggleShowInfo.emit(this.showInfo)},e.prototype.toggleShowLocation=function(){this.showLocation=!this.showLocation,this.showLocation&&this.showCurrentLoc()},e.prototype.fitMap=function(){this.onFit.emit({})},e.prototype.loadMaps=function(){var t=this;if(!c.isEmpty(this.points))return void console.log("Maps already loaded");var e=i.a.app.mapBase;if(this.showLoadingDialog(),"all"!=this.mapId)return void this.loadSingleMap(e);this.mapService.loadAllMapsWithMarkers(e);var n=s.Observable.interval(this.checkInterval).subscribe(function(e){t.mapService.mapMarkers.length!=t.curPointsCtr?(t.curPointsCtr=t.mapService.mapMarkers.length,t.sameCtr=0):(t.maxWaitCtr++,t.sameCtr++,(t.maxWaitCtr>t.maxWaitTries||t.sameCtr>t.sameMax)&&(console.log("Got all addresses, rendering..."),console.log("Total no. maps: "+t.mapService.maps.length),console.log("Total no. of addresses: "+t.mapService.mapMarkers.length),t.points=t.mapService.mapMarkers,n.unsubscribe(),t.hideLoadingDialog(),t.mapService.trackUpdates=!0,t.onComplete.emit({}),t.triggerUpdate&&t.mapService.triggerUpdate(),t.mapService.maps.length>1?"all"==t.mapId&&(t.title="All Maps"):(t.title=t.mapService.maps[0].terId+" - "+t.mapService.maps[0].name,t.winRef.nativeWindow.innerWidth<=t.shortenTitleWidth&&(t.title="Map "+t.mapService.maps[0].terId)),t.subs.push(t.onAddressClick.subscribe(function(e){console.log(e),t.currentAddr=e.addrMarker,t.showAddrDlg()}))))})},e.prototype.loadSingleMap=function(t){var e=this;this.minimumClusterSize=200,this.triggerUpdate=!0,this.subs.push(this.mapService.loadMapMarkersObs(t,this.mapId).subscribe(function(t){console.log("Map: "),console.log(t),e.mapStarted=t.assgnObj.$exists()&&!c.isEmpty(t.assgnObj.started),e.currentMap=t,e.mapService.createMarkersWithStatus(t),e.points=e.mapService.mapMarkers,e.mapService.trackUpdates=!0,e.onComplete.emit({}),e.triggerUpdate&&e.mapService.triggerUpdate(),e.title=e.mapService.maps[0].terId+" - "+e.mapService.maps[0].name,e.winRef.nativeWindow.innerWidth<=e.shortenTitleWidth&&(e.title="Map "+e.mapService.maps[0].terId),e.hideLoadingDialog(),e.subs.push(e.onAddressClick.subscribe(function(t){console.log(t),e.currentAddr=t.addrMarker,e.currentAddrTitle=e.getAddressTitle(e.currentAddr.addObj),e.currentGmapUrl=e.getGmapUrl(e.currentAddr.addObj),e.showAddrDlg()}))}))},e.prototype.startMap=function(t){},e.prototype.getAddressTitle=function(t){var e=t.unit;return(e=c.isEmpty(e)||"9"==""+e?"":"Unit "+e)+" "+t.hnum+" "+t.st+", "+t.burb},e.prototype.getGmapUrl=function(t){return"https://www.google.com/maps/dir/?api=1&destination="+t.hnum+" "+t.st+", "+t.burb+"&travelmode=driving"},e.prototype.showAddrDlg=function(){console.log("Opening dialog..."),this.addrDlg&&this.closeAddrDlg(),this.addrDlg=this.dialog.open(v,{data:{consumer:this},disableClose:!0})},e.prototype.closeAddrDlg=function(){console.log("Closing dialog..."),this.addrDlg.close(),this.addrDlg=null},e.prototype.showCurrentLoc=function(){var t=this;navigator.geolocation&&navigator.geolocation.watchPosition(function(e){t.currentLocation.addObj.clat=e.coords.latitude,t.currentLocation.addObj.clang=e.coords.longitude,console.log("Curernt position:"),console.log(e.coords),t.currentLocation.pushed||(t.currentLocation.pushed=!0,t.points.push(t.currentLocation))},function(t){console.error(t)})},e.prototype.clearMaps=function(){this.mapService.clearAllMarkers(),this.currentLocation.pushed=!1},e.prototype.showMarker=function(){this.clearMaps()},e.prototype.logout=function(){this.clearMaps(),t.prototype.logout.call(this),this.triggerUpdate=!0},e.prototype.isAdmin=function(){return this.fireAuth.currentUser&&this.fireAuth.currentUser.isAdmin()},e.prototype.onStatusChange=function(t){},e.prototype.saveStatus=function(){this.closeAddrDlg(),this.showLoadingDialog(),console.log("Status: "+this.currentAddr.addObj.status),this.mapService.updateAddrStat(this.currentAddr.mapObj.$key,this.currentAddr.addId,this.currentAddr.addObj.status)},e}(d.a);y=m([n.i(o.Component)({selector:"map-component",template:n("3CHR"),styles:[n("KJMk")]}),g("design:paramtypes",["function"==typeof(_=void 0!==r.a&&r.a)&&_||Object,"function"==typeof(j=void 0!==a.a&&a.a)&&j||Object,"function"==typeof(w=void 0!==l.a&&l.a)&&w||Object,"function"==typeof(M=void 0!==p.b&&p.b)&&M||Object,"function"==typeof(O=void 0!==u.a&&u.a)&&O||Object])],y);var v=function(){function t(t,e,n,o){this.dialogRef=t,this.data=e,n.addSvgIcon("google-map",o.bypassSecurityTrustResourceUrl("/assets/images/google-maps.svg"))}return t}();v=m([n.i(o.Component)({selector:"addr-component",template:n("Z/XM")}),b(1,n.i(o.Inject)(a.b)),g("design:paramtypes",["function"==typeof(k=void 0!==a.c&&a.c)&&k||Object,Object,"function"==typeof(x=void 0!==a.d&&a.d)&&x||Object,"function"==typeof(C=void 0!==h.c&&h.c)&&C||Object])],v);var _,j,w,M,O,k,x,C},wQAS:function(t,e,n){"use strict";var o=n("/oeL");n.d(e,"a",function(){return s});var r=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},s=function(){function t(){}return t}();s=r([n.i(o.Component)({selector:"app-root",template:n("efyd"),styles:[n("hxJY")]})],s)},xwLn:function(t,e,n){"use strict";var o=n("/oeL"),r=n("a0oU"),s=n("Dqrr"),i=(n.n(s),n("xrDH")),a=(n.n(i),n("Xir+"));n.n(a);n.d(e,"a",function(){return u});var c=this&&this.__decorate||function(t,e,n,o){var r,s=arguments.length,i=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(i=(s<3?r(i):s>3?r(e,n,i):r(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t){this.gmapsApi=t,this.markers=[],this.maxTypeIdx=3,this.maxColorIdx=3,this.markerIcons=[],this.style={url:"/assets/images/place-markers/cluster.png",height:40,width:40,textColor:"#FFF",textSize:11,backgroundPosition:"center center"},this.options={imagePath:"/assets/images/place-markers/cluster",gridSize:20,minimumClusterSize:2,styles:[this.style,this.style,this.style]},this.minimumClusterSize=2}return t.prototype.ngOnInit=function(){var t=this;this.onUpdate.subscribe(function(e){t.clearMarkers(),t.loadPoints()}),this.onSetShowClusterInfo.subscribe(function(e){t.markerCluster.setShowInfo(e)}),this.onFit&&this.onFit.subscribe(function(e){t.fitBounds()}),this.onClear&&this.onClear.subscribe(function(e){t.clearMarkers()})},t.prototype.ngOnChanges=function(t){this.clearMarkers(),this.loadPoints()},t.prototype.loadPoints=function(){var t=this;if(!this.points||0==this.points.length)return void console.log("No points to load...");this.bounds=new google.maps.LatLngBounds,this.gmapsApi.getNativeMap().then(function(e){if(i.isEmpty(t.markerIcons)){t.scaledMarkerSize=new google.maps.Size(35,35);for(var n=0;n<=t.maxTypeIdx;n++)for(var o=0;o<=t.maxColorIdx;o++){var r="/assets/images/place-markers/pin-"+n+"-"+o+".svg";t.markerIcons.push({scaledSize:t.scaledMarkerSize,url:r})}}s.Observable.interval(500).skipWhile(function(e){return null==t.points||t.points.length<=0}).take(1).subscribe(function(){if(t.points.length>0){console.log("Painting markers...");for(var n=t.onAddressClick,o=0,r=t.points;o<r.length;o++){var s=r[o];!function(o){var r=new google.maps.Marker({position:new google.maps.LatLng(o.addObj.clat,o.addObj.clong),icon:t.markerIcons[o.markerIdx%t.markerIcons.length]});if(o.marker&&(r=o.marker),o.modalMode)r.addListener("click",function(){n.emit({gmap:e,gmarker:r,addrMarker:o})});else{var s='<div id="info-window">'+o.infoWindowStr+"</div>";r.infoWindowStr=o.infoWindowStr;var i=new google.maps.InfoWindow({content:s});r.addListener("click",function(){i.open(e,r)})}t.markers.push(r),t.bounds.extend(r.getPosition())}(s)}}else t.markers=[];t.options.minimumClusterSize=t.minimumClusterSize,t.markerCluster=new MarkerClusterer(e,t.markers,t.options),e.setCenter(t.bounds.getCenter()),e.fitBounds(t.bounds)})})},t.prototype.clearMarkers=function(){this.markerCluster&&(this.markers=[],this.markerCluster.clearMarkers())},t.prototype.fitBounds=function(){var t=this;this.gmapsApi.getNativeMap().then(function(e){e.setCenter(t.bounds.getCenter()),e.fitBounds(t.bounds)})},t}();c([n.i(o.Input)(),p("design:type",Array)],u.prototype,"points",void 0),c([n.i(o.Input)(),p("design:type","function"==typeof(d=void 0!==o.EventEmitter&&o.EventEmitter)&&d||Object)],u.prototype,"onUpdate",void 0),c([n.i(o.Input)(),p("design:type","function"==typeof(l=void 0!==o.EventEmitter&&o.EventEmitter)&&l||Object)],u.prototype,"onFit",void 0),c([n.i(o.Input)(),p("design:type","function"==typeof(h=void 0!==o.EventEmitter&&o.EventEmitter)&&h||Object)],u.prototype,"onSetShowClusterInfo",void 0),c([n.i(o.Input)(),p("design:type","function"==typeof(f=void 0!==o.EventEmitter&&o.EventEmitter)&&f||Object)],u.prototype,"onClear",void 0),c([n.i(o.Input)(),p("design:type","function"==typeof(m=void 0!==o.EventEmitter&&o.EventEmitter)&&m||Object)],u.prototype,"onAddressClick",void 0),c([n.i(o.Input)(),p("design:type",Array)],u.prototype,"markerIcons",void 0),c([n.i(o.Input)(),p("design:type",Object)],u.prototype,"style",void 0),c([n.i(o.Input)(),p("design:type",Object)],u.prototype,"options",void 0),c([n.i(o.Input)(),p("design:type",Number)],u.prototype,"minimumClusterSize",void 0),u=c([n.i(o.Directive)({selector:"marker-cluster"}),p("design:paramtypes",["function"==typeof(g=void 0!==r.b&&r.b)&&g||Object])],u);var d,l,h,f,m,g},zgAq:function(t,e){t.exports='<div>\n  \x3c!-- <div class="flex-container"\n     fxLayout="row"\n     fxLayout.xs="row"\n     fxLayoutAlign="space-around none"\n     fxLayoutAlign.xs="start"> --\x3e\n     <md-toolbar [ngClass]="\'bgc-blue-grey-900 whiteText marginTopBottom-2\'">\n        <userinfo></userinfo>\n        <span class="fill-remaining-space"></span>\n        <span><a style="margin-right: 10px;" md-mini-fab [routerLink]="[\'/map/all\']" *ngIf="canViewAllMaps()"><md-icon >map</md-icon></a></span>\n        <span><button md-mini-fab (click)="logout()"><md-icon>exit_to_app</md-icon></button></span>\n     </md-toolbar>\n   \x3c!-- </div> --\x3e\n  <mapslist-component #myMapsList></mapslist-component>\n</div>\n'}},[0]);